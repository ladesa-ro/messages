{
    "$schema": "https://json-schema.org/draft/2020-12/schema",
    "$id": "schema.json",
    "$defs": {
        "TimeSlot": {
            "$schema": "https://json-schema.org/draft/2020-12/schema",
            "$id": "TimeSlot.json",
            "type": "object",
            "properties": {
                "start": {
                    "type": "string",
                    "format": "time"
                },
                "end": {
                    "type": "string",
                    "format": "time"
                }
            },
            "required": [
                "start",
                "end"
            ]
        },
        "AvailabilityRuleUnavailability": {
            "$schema": "https://json-schema.org/draft/2020-12/schema",
            "$id": "AvailabilityRuleUnavailability.json",
            "type": "object",
            "properties": {
                "r_rule": {
                    "type": "string"
                },
                "date_start": {
                    "type": "string"
                },
                "date_end": {
                    "anyOf": [
                        {
                            "type": "string"
                        },
                        {
                            "type": "null"
                        }
                    ]
                }
            },
            "required": [
                "r_rule",
                "date_start",
                "date_end"
            ]
        },
        "Availability": {
            "$schema": "https://json-schema.org/draft/2020-12/schema",
            "$id": "Availability.json",
            "type": "object",
            "properties": {
                "rules": {
                    "type": "array",
                    "items": {
                        "$ref": "AvailabilityRuleUnavailability.json"
                    }
                }
            },
            "required": [
                "rules"
            ]
        },
        "Diary": {
            "$schema": "https://json-schema.org/draft/2020-12/schema",
            "$id": "Diary.json",
            "type": "object",
            "properties": {
                "id": {
                    "type": "string"
                },
                "group_id": {
                    "type": "string"
                },
                "teacher_id": {
                    "type": "string"
                },
                "subject_id": {
                    "type": "string"
                },
                "week_limit": {
                    "type": "integer",
                    "minimum": 0,
                    "maximum": 65535
                },
                "remaining": {
                    "type": "integer",
                    "minimum": 0,
                    "maximum": 65535
                }
            },
            "required": [
                "id",
                "group_id",
                "teacher_id",
                "subject_id",
                "week_limit",
                "remaining"
            ]
        },
        "GeneratedTimetable": {
            "$schema": "https://json-schema.org/draft/2020-12/schema",
            "$id": "GeneratedTimetable.json",
            "type": "object",
            "properties": {
                "time_table": {
                    "$ref": "TimetableGrid.json"
                },
                "score": {
                    "type": "integer",
                    "minimum": 0,
                    "maximum": 65535
                }
            },
            "required": [
                "time_table",
                "score"
            ]
        },
        "TimetableGrid": {
            "$schema": "https://json-schema.org/draft/2020-12/schema",
            "$id": "TimetableGrid.json",
            "type": "object",
            "properties": {
                "date_start": {
                    "type": "string"
                },
                "date_end": {
                    "type": "string"
                },
                "time_slots": {
                    "type": "array",
                    "items": {
                        "$ref": "TimeSlot.json"
                    }
                },
                "schedules": {
                    "type": "array",
                    "items": {
                        "$ref": "TimetableGridSchedule.json"
                    }
                }
            },
            "required": [
                "date_start",
                "date_end",
                "time_slots",
                "schedules"
            ]
        },
        "TimetableGridSchedule": {
            "$schema": "https://json-schema.org/draft/2020-12/schema",
            "$id": "TimetableGridSchedule.json",
            "type": "object",
            "properties": {
                "date": {
                    "type": "string"
                },
                "diary_id": {
                    "type": "string"
                },
                "teacher_id": {
                    "type": "string"
                },
                "group_id": {
                    "type": "string"
                },
                "time_slot": {
                    "$ref": "TimeSlot.json"
                }
            },
            "required": [
                "date",
                "diary_id",
                "teacher_id",
                "group_id",
                "time_slot"
            ]
        },
        "Group": {
            "$schema": "https://json-schema.org/draft/2020-12/schema",
            "$id": "Group.json",
            "type": "object",
            "properties": {
                "id": {
                    "type": "string"
                },
                "availability": {
                    "$ref": "Availability.json"
                }
            },
            "required": [
                "id",
                "availability"
            ]
        },
        "Subject": {
            "$schema": "https://json-schema.org/draft/2020-12/schema",
            "$id": "Subject.json",
            "type": "object",
            "properties": {
                "id": {
                    "type": "string"
                },
                "name": {
                    "type": "string"
                }
            },
            "required": [
                "id",
                "name"
            ]
        },
        "Teacher": {
            "$schema": "https://json-schema.org/draft/2020-12/schema",
            "$id": "Teacher.json",
            "type": "object",
            "properties": {
                "id": {
                    "type": "string"
                },
                "availability": {
                    "$ref": "Availability.json"
                }
            },
            "required": [
                "id",
                "availability"
            ]
        },
        "GenerateRequest": {
            "$schema": "https://json-schema.org/draft/2020-12/schema",
            "$id": "GenerateRequest.json",
            "type": "object",
            "properties": {
                "request_id": {
                    "type": "string"
                },
                "date_start": {
                    "type": "string"
                },
                "date_end": {
                    "type": "string"
                },
                "groups": {
                    "type": "array",
                    "items": {
                        "$ref": "Group.json"
                    }
                },
                "teachers": {
                    "type": "array",
                    "items": {
                        "$ref": "Teacher.json"
                    }
                },
                "diarys": {
                    "type": "array",
                    "items": {
                        "$ref": "Diary.json"
                    }
                },
                "time_slots": {
                    "type": "array",
                    "items": {
                        "$ref": "TimeSlot.json"
                    }
                },
                "previous_timetable_grid": {
                    "anyOf": [
                        {
                            "$ref": "TimetableGrid.json"
                        },
                        {
                            "type": "null"
                        }
                    ]
                }
            },
            "required": [
                "request_id",
                "date_start",
                "date_end",
                "groups",
                "teachers",
                "diarys",
                "time_slots",
                "previous_timetable_grid"
            ]
        },
        "ServiceGenerateResponseResultError": {
            "$schema": "https://json-schema.org/draft/2020-12/schema",
            "$id": "ServiceGenerateResponseResultError.json",
            "type": "object",
            "properties": {
                "error_code": {
                    "type": "string"
                },
                "error_message": {
                    "type": "string"
                },
                "additional_info": {
                    "anyOf": [
                        {
                            "type": "string"
                        },
                        {
                            "type": "null"
                        }
                    ]
                }
            },
            "required": [
                "error_code",
                "error_message",
                "additional_info"
            ]
        },
        "ServiceGenerateResponseResultSuccess": {
            "$schema": "https://json-schema.org/draft/2020-12/schema",
            "$id": "ServiceGenerateResponseResultSuccess.json",
            "type": "object",
            "properties": {
                "request_id": {
                    "type": "string"
                },
                "generate_request": {
                    "$ref": "GenerateRequest.json"
                },
                "generated_timetables": {
                    "type": "array",
                    "items": {
                        "$ref": "GeneratedTimetable.json"
                    }
                }
            },
            "required": [
                "request_id",
                "generate_request",
                "generated_timetables"
            ]
        },
        "ServiceGenerateResponse": {
            "$schema": "https://json-schema.org/draft/2020-12/schema",
            "$id": "ServiceGenerateResponse.json",
            "type": "object",
            "properties": {
                "request_id": {
                    "type": "string"
                },
                "date_time_issued": {
                    "type": "string"
                },
                "result": {
                    "anyOf": [
                        {
                            "$ref": "ServiceGenerateResponseResultSuccess.json"
                        },
                        {
                            "$ref": "ServiceGenerateResponseResultError.json"
                        }
                    ]
                }
            },
            "required": [
                "request_id",
                "date_time_issued",
                "result"
            ]
        },
        "WeekDay": {
            "$schema": "https://json-schema.org/draft/2020-12/schema",
            "$id": "WeekDay.json",
            "type": "string",
            "enum": [
                "Sunday",
                "Monday",
                "Tuesday",
                "Wednesday",
                "Thursday",
                "Friday",
                "Saturday"
            ]
        }
    }
}